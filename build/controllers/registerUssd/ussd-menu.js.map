{"version":3,"sources":["../../../src/controllers/registerUssd/ussd-menu.js"],"names":["username","password","baseURL","Ussd","res","req","end","queryString","getQuery","parseUrl","qs","parse","meta","metaValue","split","msisdn","smsc","shortcode","text","keyword","id","smsBoxUrl","GENDER_SELECTION","metaValueTwo","data","menu","session","client","setex","get","err","result","ansExist","genderIndex","gender","GENDER_ARRAY_Q1","raw","INCIDENCE_SELECTION","GENDER_SELECTION_INVALID","incidenceIndex","incidenceType","INCIDENCE_ARRAY_Q2","incidence","STATE_ALPHABET_SELECTION","INCIDENCE_SELECTION_INVALID","firstLetter","STATE_SELECTION_PAGE1","STATE_SELECTION_PAGE2","STATE_SELECTION_PAGE3","STATE_SELECTION_PAGE4","STATE_SELECTION_PAGE5","stateIndex","state","STATE_ARRAY_1","STATE_ARRAY_2","STATE_ARRAY_3","STATE_ARRAY_4","STATE_ARRAY_5","phoneNumber","date","Date","toISOString","dateValue","postData","created_date","phone_number","reporter_state","type","sql","con","query","console","log","SUCCESS_MESSAGE","metaValue16","DEL","STATE_ALPHABET_SELECTION_INVALID","empty","Error"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AAEA;;AACA;;AACA;;AAUA;;AAgBA;;AAEA,IAAMA,QAAQ,GAAG,MAAjB;AACA,IAAMC,QAAQ,GAAG,MAAjB;AACA,IAAMC,OAAO,GAAG,uCAAhB;;IAEqBC,I;;;;;;;;iIACgBC,G,EAAKC,G;;;;;;;AAClCD,gBAAAA,GAAG,CAACE,GAAJ,G,CACA;;AACMC,gBAAAA,W,GAAcF,GAAG,CAACG,QAAJ,E,EACpB;;;;qBAEGD,W;;;;;AACOE,gBAAAA,Q,GAAWC,eAAGC,KAAH,CAASJ,WAAT,C;AACXK,gBAAAA,I,GAAOH,QAAQ,CAAC,WAAD,C;;sBAClBG,IAAI,IAAI,qCAAAH,QAAQ,CAAC,WAAD,CAAR,iBAA+B,IAA/B,C;;;;;AACDI,gBAAAA,S,GAAYD,IAAI,CAACE,KAAL,CAAW,IAAX,EAAiB,CAAjB,EAAoBA,KAApB,CAA0B,GAA1B,EAA+B,CAA/B,C;AACVC,gBAAAA,M,GAA+CN,Q,CAA/CM,M,EAAQC,I,GAAuCP,Q,CAAvCO,I,EAAMC,S,GAAiCR,Q,CAAjCQ,S,EAAWC,I,GAAsBT,Q,CAAtBS,I,EAAMC,O,GAAgBV,Q,CAAhBU,O,EAASC,E,GAAOX,Q,CAAPW,E;AAC1CC,gBAAAA,S,GAAYZ,QAAQ,CAAC,YAAD,C;;sBACvBI,SAAS,IAAIE,MAAb,IAAuBC,IAAvB,IAA+BC,SAA/B,IAA4CC,IAA5C,IAAoDG,SAApD,IAAiEF,O;;;;;AAChE,oBAAGJ,MAAM,IAAI,eAAV,IAA6BA,MAAM,IAAI,eAAvC,IAA0DA,MAAM,IAAI,eAApE,IAAuFA,MAAM,IAAI,eAApG,EAAoH;AAChH,sBAAGF,SAAS,IAAI,IAAb,IAAqB,0BAAAK,IAAI,MAAJ,CAAAA,IAAI,EAAU,GAAV,CAA5B,EAA2C;AACvC,qDAAahB,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmEO,4BAAnE,EAAqFC,wBAArF,EAAmGJ,OAAnG,EAA4GC,EAA5G,EAAgHC,SAAhH;AACMG,oBAAAA,IAFiC,GAE1B;AAAEC,sBAAAA,IAAI,EAAE,GAAR;AAAaC,sBAAAA,OAAO,EAAE;AAACX,wBAAAA,MAAM,EAAEA;AAAT;AAAtB,qBAF0B;;AAGvCY,4CAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0B,kCAAcS,IAAd,CAA1B;AACH,mBAJD,MAIO,IAAGX,SAAS,IAAI,IAAhB,EAAqB;AACxBc,4CAAOE,GAAP,CAAWd,MAAX;AAAA,+GAAmB,iBAAOe,GAAP,EAAYC,MAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AACTC,gCAAAA,QADS,GACE,8BAAUD,MAAV,CADF;;AAEf,oCAAIC,QAAQ,CAACP,IAAT,IAAiB,GAArB,EAA0B;AAC1B,sCAAIP,IAAI,IAAI,GAAR,IAAeA,IAAI,IAAI,GAA3B,EAA+B;AACrBe,oCAAAA,WADqB,GACP,2BAASf,IAAT,IAAiB,CADV;AAErBgB,oCAAAA,MAFqB,GAEZC,2BAAgBF,WAAhB,CAFY;AAGrBG,oCAAAA,GAHqB,GAGf;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA;AAAzB;AAAtB,qCAHe;AAIrBV,oCAAAA,KAJqB,GAId,kCAAcY,GAAd,CAJc;AAK3B,qEAAalC,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmEsB,+BAAnE,EAAwFd,wBAAxF,EAAqGJ,OAArG,EAA8GC,EAA9G,EAAiHC,SAAjH;;AACAM,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,KAA1B;AACC,mCAPL,MAOW;AACH,qEAAatB,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmEuB,oCAAnE,EAA6Ff,wBAA7F,EAA2GJ,OAA3G,EAAoHC,EAApH,EAAwHC,SAAxH;AACMG,oCAAAA,MAFH,GAEU;AAAEC,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA;AAAT;AAAtB,qCAFV;;AAGHY,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0B,kCAAcS,MAAd,CAA1B;AACH;AACR;;AAfkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAAnB;;AAAA;AAAA;AAAA;AAAA;;AAiBFG,4CAAOE,GAAP,CAAWd,MAAX;AAAA,gHAAmB,kBAAOe,GAAP,EAAYC,MAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AACXC,gCAAAA,QADW,GACA,8BAAUD,MAAV,CADA;;AAEjB,oCAAIC,QAAQ,CAACP,IAAT,IAAiB,GAArB,EAA0B;AAClB,sCAAIP,IAAI,IAAI,GAAR,IAAeA,IAAI,IAAI,GAAvB,IAA8BA,IAAI,IAAI,GAAtC,IAA6CA,IAAI,IAAI,GAArD,IAA4DA,IAAI,IAAI,GAAxE,EAA4E;AAClEqB,oCAAAA,cADkE,GACjD,2BAASrB,IAAT,IAAiB,CADgC;AAElEsB,oCAAAA,aAFkE,GAElDC,8BAAmBF,cAAnB,CAFkD;AAGlEL,oCAAAA,MAHkE,GAGzDF,QAAQ,CAACN,OAAT,CAAiBQ,MAHwC;AAIlEE,oCAAAA,GAJkE,GAI5D;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,wCAAAA,SAAS,EAAEF;AAA5C;AAAtB,qCAJ4D;AAKlEhB,oCAAAA,MALkE,GAK3D,kCAAcY,GAAd,CAL2D;AAMxE,qEAAalC,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE4B,oCAAnE,EAA6FpB,wBAA7F,EAA2GJ,OAA3G,EAAoHC,EAApH,EAAwHC,SAAxH;;AACAM,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,MAA1B;AACH,mCARD,MAQO;AACGU,oCAAAA,OADH,GACYF,QAAQ,CAACN,OAAT,CAAiBQ,MAD7B;AAEGE,oCAAAA,IAFH,GAES;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA;AAAzB;AAAtB,qCAFT;;AAGHP,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0B,kCAAcqB,IAAd,CAA1B;;AACA,qEAAalC,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE6B,uCAAnE,EAAgGrB,wBAAhG,EAA8GJ,OAA9G,EAAuHC,EAAvH,EAA2HC,SAA3H;AACH;AACR;;AAjBgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAAnB;;AAAA;AAAA;AAAA;AAAA;;AAmBAM,4CAAOE,GAAP,CAAWd,MAAX;AAAA,gHAAmB,kBAAOe,GAAP,EAAYC,MAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AACXC,gCAAAA,QADW,GACA,8BAAUD,MAAV,CADA;;AAEjB,oCAAIC,QAAQ,CAACP,IAAT,IAAiB,GAArB,EAA0B;AACZS,kCAAAA,MADY,GACHF,QAAQ,CAACN,OAAT,CAAiBQ,MADd;AAEZQ,kCAAAA,SAFY,GAEAV,QAAQ,CAACN,OAAT,CAAiBgB,SAFjB;;AAGlB,sCAAIxB,IAAI,KAAK,GAAb,EAAiB;AACPkB,oCAAAA,GADO,GACD;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,wCAAAA,SAAS,EAAEA,SAA5C;AAAuDG,wCAAAA,WAAW,EAAE;AAApE;AAAtB,qCADC;AAEPrB,oCAAAA,MAFO,GAEA,kCAAcY,GAAd,CAFA;;AAGbT,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,MAA1B;;AACA,qEAAatB,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE+B,iCAAnE,EAA0FvB,wBAA1F,EAAwGJ,OAAxG,EAAiHC,EAAjH,EAAqHC,SAArH;AACN,mCALE,MAKI,IAAIH,IAAI,IAAI,GAAZ,EAAgB;AACVkB,oCAAAA,KADU,GACJ;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,wCAAAA,SAAS,EAAEA,SAA5C;AAAuDG,wCAAAA,WAAW,EAAE;AAApE;AAAtB,qCADI;AAEVrB,oCAAAA,MAFU,GAEH,kCAAcY,KAAd,CAFG;;AAGhBT,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,MAA1B;;AACA,qEAAatB,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmEgC,iCAAnE,EAA0FxB,wBAA1F,EAAwGJ,OAAxG,EAAiHC,EAAjH,EAAqHC,SAArH;AACP,mCALO,MAKD,IAAIH,IAAI,IAAI,GAAZ,EAAgB;AACTkB,oCAAAA,KADS,GACH;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,wCAAAA,SAAS,EAAEA,SAA5C;AAAuDG,wCAAAA,WAAW,EAAE;AAApE;AAAtB,qCADG;AAETrB,oCAAAA,MAFS,GAEF,kCAAcY,KAAd,CAFE;;AAGfT,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,MAA1B;;AACA,qEAAatB,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmEiC,iCAAnE,EAA0FzB,wBAA1F,EAAwGJ,OAAxG,EAAiHC,EAAjH,EAAqHC,SAArH;AACP,mCALM,MAKA,IAAIH,IAAI,IAAI,GAAZ,EAAgB;AACTkB,oCAAAA,KADS,GACH;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,wCAAAA,SAAS,EAAEA,SAA5C;AAAuDG,wCAAAA,WAAW,EAAE;AAApE;AAAtB,qCADG;AAETrB,oCAAAA,MAFS,GAEF,kCAAcY,KAAd,CAFE;;AAGfT,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,MAA1B;;AACA,qEAAatB,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmEkC,iCAAnE,EAA0F1B,wBAA1F,EAAwGJ,OAAxG,EAAiHC,EAAjH,EAAqHC,SAArH;AACP,mCALM,MAKA,IAAIH,IAAI,IAAI,GAAZ,EAAgB;AACTkB,oCAAAA,KADS,GACH;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,wCAAAA,SAAS,EAAEA,SAA5C;AAAuDG,wCAAAA,WAAW,EAAE;AAApE;AAAtB,qCADG;AAETrB,oCAAAA,MAFS,GAEF,kCAAcY,KAAd,CAFE;;AAGfT,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,MAA1B;;AACA,qEAAatB,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmEmC,iCAAnE,EAA0F3B,wBAA1F,EAAwGJ,OAAxG,EAAiHC,EAAjH,EAAqHC,SAArH;AACP,mCALM,MAKA,IAAIH,IAAI,IAAI,GAAR,IAAeA,IAAI,KAAK,GAAxB,IAA+BA,IAAI,KAAK,GAAxC,IAA+CA,IAAI,KAAK,GAAxD,IAA+DA,IAAI,KAAK,GAAxE,IAA+EA,IAAI,KAAK,GAA5F,EAAiG;AAC1FkB,oCAAAA,KAD0F,GACpF;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,wCAAAA,SAAS,EAAEA;AAA5C;AAAtB,qCADoF;;AAEhGf,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0B,kCAAcqB,KAAd,CAA1B;;AACA,qEAAalC,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE4B,oCAAnE,EAA6FpB,wBAA7F,EAA2GJ,OAA3G,EAAoHC,EAApH,EAAwHC,SAAxH;AACH;AACR;;AAnCgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAAnB;;AAAA;AAAA;AAAA;AAAA;;AAqCAM,4CAAOE,GAAP,CAAWd,MAAX;AAAA,gHAAmB,kBAAOe,GAAP,EAAYC,MAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AACXC,gCAAAA,QADW,GACA,8BAAUD,MAAV,CADA;;AAEjB,oCAAIC,QAAQ,CAACP,IAAT,IAAiB,GAArB,EAA0B;AACtB,sCAAIP,IAAI,IAAI,GAAR,IAAeA,IAAI,IAAI,GAAvB,IAA8BA,IAAI,IAAI,GAAtC,IAA6CA,IAAI,IAAI,GAArD,IAA4DA,IAAI,IAAI,GAApE,IAA2EA,IAAI,IAAI,GAAnF,IAA0FA,IAAI,IAAI,GAAlG,IAAyGA,IAAI,IAAI,GAArH,EAAyH;AAC/GgB,oCAAAA,MAD+G,GACtGF,QAAQ,CAACN,OAAT,CAAiBQ,MADqF;AAE/GQ,oCAAAA,SAF+G,GAEnGV,QAAQ,CAACN,OAAT,CAAiBgB,SAFkF;;AAGrH,wCAAGV,QAAQ,CAACN,OAAT,CAAiBmB,WAAjB,IAAgC,KAAnC,EAAyC;AAC/BM,sCAAAA,UAD+B,GAClB,2BAASjC,IAAT,IAAiB,CADC;AAE/BkC,sCAAAA,KAF+B,GAEvBC,yBAAcF,UAAd,CAFuB;AAG/Bf,sCAAAA,GAH+B,GAGzB;AAAEX,wCAAAA,IAAI,EAAE,GAAR;AAAaC,wCAAAA,OAAO,EAAE;AAACX,0CAAAA,MAAM,EAAEA,MAAT;AAAiBmB,0CAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,0CAAAA,SAAS,EAAEA,SAA5C;AAAuDG,0CAAAA,WAAW,EAAE,KAApE;AAA2EO,0CAAAA,KAAK,EAAEA;AAAlF;AAAtB,uCAHyB;AAI/B5B,sCAAAA,MAJ+B,GAIxB,kCAAcY,GAAd,CAJwB;;AAKrCT,8DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,MAA1B;AACH,qCAND,MAMO,IAAGQ,QAAQ,CAACN,OAAT,CAAiBmB,WAAjB,IAAgC,KAAnC,EAAyC;AACtCM,sCAAAA,WADsC,GACzB,2BAASjC,IAAT,IAAiB,CADQ;AAEtCkC,sCAAAA,MAFsC,GAE9BE,yBAAcH,WAAd,CAF8B;AAGtCf,sCAAAA,KAHsC,GAGhC;AAAEX,wCAAAA,IAAI,EAAE,GAAR;AAAaC,wCAAAA,OAAO,EAAE;AAACX,0CAAAA,MAAM,EAAEA,MAAT;AAAiBmB,0CAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,0CAAAA,SAAS,EAAEA,SAA5C;AAAuDG,0CAAAA,WAAW,EAAE,KAApE;AAA2EO,0CAAAA,KAAK,EAAEA;AAAlF;AAAtB,uCAHgC;AAItC5B,sCAAAA,OAJsC,GAI/B,kCAAcY,KAAd,CAJ+B;;AAK5CT,8DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,OAA1B;AACH,qCANM,MAMA,IAAGQ,QAAQ,CAACN,OAAT,CAAiBmB,WAAjB,IAAgC,KAAnC,EAAyC;AACtCM,sCAAAA,YADsC,GACzB,2BAASjC,IAAT,IAAiB,CADQ;AAEtCkC,sCAAAA,OAFsC,GAE9BG,yBAAcJ,YAAd,CAF8B;AAGtCf,sCAAAA,KAHsC,GAGhC;AAAEX,wCAAAA,IAAI,EAAE,GAAR;AAAaC,wCAAAA,OAAO,EAAE;AAACX,0CAAAA,MAAM,EAAEA,MAAT;AAAiBmB,0CAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,0CAAAA,SAAS,EAAEA,SAA5C;AAAuDG,0CAAAA,WAAW,EAAE,KAApE;AAA2EO,0CAAAA,KAAK,EAAEA;AAAlF;AAAtB,uCAHgC;AAItC5B,sCAAAA,OAJsC,GAI/B,kCAAcY,KAAd,CAJ+B;;AAK5CT,8DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,OAA1B;AACH,qCANM,MAMA,IAAGQ,QAAQ,CAACN,OAAT,CAAiBmB,WAAjB,IAAgC,KAAnC,EAAyC;AACtCM,sCAAAA,YADsC,GACzB,2BAASjC,IAAT,IAAiB,CADQ;AAEtCkC,sCAAAA,OAFsC,GAE9BI,yBAAcL,YAAd,CAF8B;AAGtCf,sCAAAA,KAHsC,GAGhC;AAAEX,wCAAAA,IAAI,EAAE,GAAR;AAAaC,wCAAAA,OAAO,EAAE;AAACX,0CAAAA,MAAM,EAAEA,MAAT;AAAiBmB,0CAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,0CAAAA,SAAS,EAAEA,SAA5C;AAAuDG,0CAAAA,WAAW,EAAE,KAApE;AAA2EO,0CAAAA,KAAK,EAAEA;AAAlF;AAAtB,uCAHgC;AAItC5B,sCAAAA,OAJsC,GAI/B,kCAAcY,KAAd,CAJ+B;;AAK5CT,8DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,OAA1B;AACH,qCANM,MAMA;AACG2B,sCAAAA,YADH,GACgB,2BAASjC,IAAT,IAAiB,CADjC;AAEGkC,sCAAAA,OAFH,GAEWK,yBAAcN,YAAd,CAFX;AAGGf,sCAAAA,MAHH,GAGS;AAAEX,wCAAAA,IAAI,EAAE,GAAR;AAAaC,wCAAAA,OAAO,EAAE;AAACX,0CAAAA,MAAM,EAAEA,MAAT;AAAiBmB,0CAAAA,MAAM,EAAEA,MAAzB;AAAiCQ,0CAAAA,SAAS,EAAEA,SAA5C;AAAuDG,0CAAAA,WAAW,EAAE,KAApE;AAA2EO,0CAAAA,KAAK,EAAEA;AAAlF;AAAtB,uCAHT;AAIG5B,sCAAAA,OAJH,GAIU,kCAAcY,MAAd,CAJV;;AAKHT,8DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0BS,OAA1B;AACH,qCAjCoH,CAkCrH;;;AACAG,4DAAOE,GAAP,CAAWd,MAAX;AAAA,gIAAmB,kBAAOe,GAAP,EAAYC,MAAZ;AAAA;AAAA;AAAA;AAAA;AAAA;AACTC,gDAAAA,QADS,GACE,8BAAUD,MAAV,CADF;AAETG,gDAAAA,MAFS,GAEAF,QAAQ,CAACN,OAAT,CAAiBQ,MAFjB;AAGTQ,gDAAAA,SAHS,GAGGV,QAAQ,CAACN,OAAT,CAAiBgB,SAHpB;AAITU,gDAAAA,KAJS,GAIDpB,QAAQ,CAACN,OAAT,CAAiB0B,KAJhB;AAKTM,gDAAAA,WALS,GAKK1B,QAAQ,CAACN,OAAT,CAAiBX,MALtB;AAMT4C,gDAAAA,IANS,GAMF,IAAIC,IAAJ,GAAWC,WAAX,EANE;AAOTC,gDAAAA,SAPS,GAOGH,IAAI,CAAC7C,KAAL,CAAW,GAAX,EAAgB,CAAhB,CAPH,EAQf;;AACIiD,gDAAAA,QATW,GASA;AACXC,kDAAAA,YAAY,EAAEF,SADH;AAEX5B,kDAAAA,MAAM,EAAEA,MAFG;AAGX+B,kDAAAA,YAAY,EAAEP,WAHH;AAIXQ,kDAAAA,cAAc,EAAEd,KAJL;AAKXe,kDAAAA,IAAI,EAAEzB;AALK,iDATA;AAgBX0B,gDAAAA,GAhBW,GAgBL,6BAhBK;;AAiBXC,8DAAIC,KAAJ,CAAUF,GAAV,EAAeL,QAAf,EAAyB,UAAUjC,GAAV,EAAeC,MAAf,EAAuB;AAC5C,sDAAID,GAAJ,EAAS;AACLyC,oDAAAA,OAAO,CAACC,GAAR,CAAY,KAAZ,EAAmB1C,GAAnB;AACH,mDAFD,MAEM;AACNyC,oDAAAA,OAAO,CAACC,GAAR,CAAY,4BAA4BzC,MAAxC;AACC;AACJ,iDAND;;AAjBW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uCAAnB;;AAAA;AAAA;AAAA;AAAA;;AAyBI,qEAAa7B,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE0D,2BAAnE,EAAoFC,uBAApF,EAAiGvD,OAAjG,EAA0GC,EAA1G,EAA8GC,SAA9G;;AACRM,4DAAOgD,GAAP,CAAW5D,MAAX;AACH,mCA9DG,MA8DG,IAAIG,IAAI,IAAI,GAAZ,EAAiB;AACdgB,oCAAAA,QADc,GACLF,QAAQ,CAACN,OAAT,CAAiBQ,MADZ;AAEdQ,oCAAAA,UAFc,GAEFV,QAAQ,CAACN,OAAT,CAAiBgB,SAFf;AAGdN,oCAAAA,MAHc,GAGR;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA,QAAzB;AAAiCQ,wCAAAA,SAAS,EAAEA;AAA5C;AAAtB,qCAHQ;;AAIpBf,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0B,kCAAcqB,MAAd,CAA1B;;AACA,qEAAalC,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE4B,oCAAnE,EAA6FpB,wBAA7F,EAA2GJ,OAA3G,EAAoHC,EAApH,EAAwHC,SAAxH;AACH,mCANM,MAMA,IAAIH,IAAI,KAAK,GAAT,IAAgBA,IAAI,KAAK,GAAzB,IAAgCA,IAAI,KAAK,GAAzC,IAAgDA,IAAI,KAAK,GAAzD,IAAgEA,IAAI,KAAK,GAAzE,IAAgFA,IAAI,KAAK,GAAzF,IAAgGA,IAAI,KAAK,GAAzG,IAAgHA,IAAI,KAAK,GAAzH,IAAgIA,IAAI,KAAK,GAA7I,EAAkJ;AAC/IgB,oCAAAA,QAD+I,GACtIF,QAAQ,CAACN,OAAT,CAAiBQ,MADqH;AAE/IQ,oCAAAA,WAF+I,GAEnIV,QAAQ,CAACN,OAAT,CAAiBgB,SAFkH;AAG/IN,oCAAAA,MAH+I,GAGzI;AAAEX,sCAAAA,IAAI,EAAE,GAAR;AAAaC,sCAAAA,OAAO,EAAE;AAACX,wCAAAA,MAAM,EAAEA,MAAT;AAAiBmB,wCAAAA,MAAM,EAAEA,QAAzB;AAAiCQ,wCAAAA,SAAS,EAAEA;AAA5C;AAAtB,qCAHyI;;AAIrJf,4DAAOC,KAAP,CAAab,MAAb,EAAqB,GAArB,EAA0B,kCAAcqB,MAAd,CAA1B;;AACA,qEAAalC,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE6D,4CAAnE,EAAqGrD,wBAArG,EAAmHJ,OAAnH,EAA4HC,EAA5H,EAAgIC,SAAhI;AACH;AACA;;AA9EgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAAnB;;AAAA;AAAA;AAAA;AAAA;AAgFD,mBA1JM,MA0JA,IAAIR,SAAS,IAAI,IAAb,IAAqBA,SAAS,IAAI,IAAtC,EAA2C;AACxCgE,oBAAAA,KADwC,GAChC,EADgC;AAE9C,qDAAa3E,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE8D,KAAnE,EAA0EH,uBAA1E,EAAuFvD,OAAvF,EAAgGC,EAAhG,EAAoGC,SAApG;AACH,mBAHM,MAGA;AACGwD,oBAAAA,MADH,GACW,EADX;AAEH,qDAAa3E,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE8D,MAAnE,EAA0EH,uBAA1E,EAAuFvD,OAAvF,EAAgGC,EAAhG,EAAoGC,SAApG;AACH;AACJ,iBAtKD,MAsKO;AACGwD,kBAAAA,OADH,GACW,EADX;AAEH,mDAAa3E,OAAb,EAAsBF,QAAtB,EAAgCC,QAAhC,EAA0CgB,SAA1C,EAAqDD,IAArD,EAA2DD,MAA3D,EAAmE8D,OAAnE,EAA0EH,uBAA1E,EAAuFvD,OAAvF,EAAgGC,EAAhG,EAAoGC,SAApG;AACC;;;;;;sBAEC,IAAIyD,KAAJ,CAAU,uCAAV,C;;;;;;;sBAGJ,IAAIA,KAAJ,CAAU,sBAAV,C;;;;;;;sBAIJ,IAAIA,KAAJ,CAAU,uBAAV,C;;;;;;;;;AAIVP,gBAAAA,OAAO,CAACC,GAAR,CAAY,OAAZ","sourcesContent":["import qs from 'qs';\n\nimport client from '../../utils/redis-config';\nimport { con } from '../../utils/configDB';\nimport {\nGENDER_ARRAY_Q1,\nINCIDENCE_ARRAY_Q2,\nSTATE_ARRAY_1,\nSTATE_ARRAY_2,\nSTATE_ARRAY_3,\nSTATE_ARRAY_4,\nSTATE_ARRAY_5,\n} from '../../utils/constants';\n\nimport {\n    SUCCESS_MESSAGE,\n    GENDER_SELECTION,\n    INCIDENCE_SELECTION,\n    STATE_ALPHABET_SELECTION,\n    STATE_SELECTION_PAGE1,\n    STATE_SELECTION_PAGE2,\n    STATE_SELECTION_PAGE3,\n    STATE_SELECTION_PAGE4,\n    STATE_SELECTION_PAGE5,\n    GENDER_SELECTION_INVALID,\n    INCIDENCE_SELECTION_INVALID,\n    STATE_ALPHABET_SELECTION_INVALID,\n    metaValueTwo,\n    metaValue16,\n} from './constants';\nimport { createClient, stringifyData, parseData } from './ussd-functions';\n\nconst username = 'test';\nconst password = 'test';\nconst baseURL = 'http://10.0.0.56:9940/cgi-bin/sendsms';\n\nexport default class Ussd {\n    static async registerUssdDetails(res, req) {\n        res.end();\n        //console.log('request', req);\n        const queryString = req.getQuery();\n        //console.log('string', queryString);\n    try {\n        if(queryString) {\n            const parseUrl = qs.parse(queryString);\n            const meta = parseUrl['meta-data']\n            if(meta && parseUrl['meta-data'].includes('=%')){\n                const metaValue = meta.split('=%')[1].split('&')[0];\n                const { msisdn, smsc, shortcode, text, keyword, id } = parseUrl;\n                const smsBoxUrl = parseUrl['smsbox-url'];\n                if(metaValue && msisdn && smsc && shortcode && text && smsBoxUrl && keyword) {\n                    if(msisdn == '2349154100054' || msisdn == '2347058793298' || msisdn == '2348055268896' || msisdn == '2347058793301'){\n                        if(metaValue == '01' && text.includes('#')){\n                            createClient(baseURL, username, password, shortcode, smsc, msisdn, GENDER_SELECTION, metaValueTwo, keyword, id, smsBoxUrl);\n                            const data = { menu: '1', session: {msisdn: msisdn} };\n                            client.setex(msisdn, 360, stringifyData(data));\n                        } else if(metaValue == '12'){\n                            client.get(msisdn, async (err, result) => {\n                                const ansExist = parseData(result)\n                                if (ansExist.menu == '1') {\n                                if (text == '1' || text == '2'){\n                                    const genderIndex = parseInt(text) - 1;\n                                    const gender = GENDER_ARRAY_Q1[genderIndex];\n                                    const raw = { menu: '2', session: {msisdn: msisdn ,gender: gender} };\n                                    const data = stringifyData(raw);\n                                    createClient(baseURL, username, password, shortcode, smsc, msisdn, INCIDENCE_SELECTION, metaValueTwo,keyword, id,smsBoxUrl);\n                                    client.setex(msisdn, 360, data);\n                                    } else { \n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, GENDER_SELECTION_INVALID, metaValueTwo, keyword, id, smsBoxUrl);\n                                        const data = { menu: '1', session: {msisdn: msisdn} };\n                                        client.setex(msisdn, 360, stringifyData(data));\n                                    }\n                            }\n                          });\n                          client.get(msisdn, async (err, result) => {\n                            const ansExist = parseData(result)\n                            if (ansExist.menu == '2') {\n                                    if (text == '1' || text == '2' || text == '3' || text == '4' || text == '5'){\n                                        const incidenceIndex = parseInt(text) - 1;\n                                        const incidenceType = INCIDENCE_ARRAY_Q2[incidenceIndex];\n                                        const gender = ansExist.session.gender;\n                                        const raw = { menu: '3', session: {msisdn: msisdn, gender: gender, incidence: incidenceType} };\n                                        const data = stringifyData(raw);\n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, STATE_ALPHABET_SELECTION, metaValueTwo, keyword, id, smsBoxUrl);\n                                        client.setex(msisdn, 360, data);\n                                    } else {\n                                        const gender = ansExist.session.gender;\n                                        const raw = { menu: '2', session: {msisdn: msisdn, gender: gender}}\n                                        client.setex(msisdn, 360, stringifyData(raw));\n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, INCIDENCE_SELECTION_INVALID, metaValueTwo, keyword, id, smsBoxUrl);\n                                    }\n                            } \n                          });\n                          client.get(msisdn, async (err, result) => {\n                            const ansExist = parseData(result)\n                            if (ansExist.menu == '3') {\n                                    const gender = ansExist.session.gender;\n                                    const incidence = ansExist.session.incidence;\n                                    if (text === '1'){\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'A-B'} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, STATE_SELECTION_PAGE1, metaValueTwo, keyword, id, smsBoxUrl);\n                                 } else if (text == '2'){\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'C-I'} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, STATE_SELECTION_PAGE2, metaValueTwo, keyword, id, smsBoxUrl);\n                                } else if (text == '3'){\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'J-L'} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, STATE_SELECTION_PAGE3, metaValueTwo, keyword, id, smsBoxUrl);\n                                } else if (text == '4'){\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'N-R'} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, STATE_SELECTION_PAGE4, metaValueTwo, keyword, id, smsBoxUrl);\n                                } else if (text == '5'){\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'S-Z'} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, STATE_SELECTION_PAGE5, metaValueTwo, keyword, id, smsBoxUrl);\n                                } else if (text == '0' && text !== '1' || text !== '2' || text !== '3' || text !== '4' || text !== '5') {\n                                        const raw = { menu: '3', session: {msisdn: msisdn, gender: gender, incidence: incidence}}\n                                        client.setex(msisdn, 360, stringifyData(raw));\n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, STATE_ALPHABET_SELECTION, metaValueTwo, keyword, id, smsBoxUrl);\n                                    } \n                            } \n                          });\n                          client.get(msisdn, async (err, result) => {\n                            const ansExist = parseData(result)\n                            if (ansExist.menu == '4') {\n                                if (text == '1' || text == '2' || text == '3' || text == '4' || text == '5' || text == '6' || text == '7' || text == '8'){\n                                    const gender = ansExist.session.gender;\n                                    const incidence = ansExist.session.incidence;\n                                    if(ansExist.session.firstLetter == 'A-B'){\n                                        const stateIndex = parseInt(text) - 1;\n                                        const state = STATE_ARRAY_1[stateIndex];\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'A-B', state: state} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                    } else if(ansExist.session.firstLetter == 'C-I'){\n                                        const stateIndex = parseInt(text) - 1;\n                                        const state = STATE_ARRAY_2[stateIndex];\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'C-I', state: state} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                    } else if(ansExist.session.firstLetter == 'J-L'){\n                                        const stateIndex = parseInt(text) - 1;\n                                        const state = STATE_ARRAY_3[stateIndex];\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'J-L', state: state} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                    } else if(ansExist.session.firstLetter == 'N-R'){\n                                        const stateIndex = parseInt(text) - 1;\n                                        const state = STATE_ARRAY_4[stateIndex];\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'N-R', state: state} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                    } else {\n                                        const stateIndex = parseInt(text) - 1;\n                                        const state = STATE_ARRAY_5[stateIndex];\n                                        const raw = { menu: '4', session: {msisdn: msisdn, gender: gender, incidence: incidence, firstLetter: 'S-Z', state: state} };\n                                        const data = stringifyData(raw);\n                                        client.setex(msisdn, 360, data);\n                                    }\n                                    // retrieve values\n                                    client.get(msisdn, async (err, result) => {\n                                        const ansExist = parseData(result)\n                                        const gender = ansExist.session.gender;\n                                        const incidence = ansExist.session.incidence;\n                                        const state = ansExist.session.state;\n                                        const phoneNumber = ansExist.session.msisdn;\n                                        const date = new Date().toISOString();\n                                        const dateValue = date.split('T')[0];\n                                        // Bulk insert into DB and clear cache\n                                        let postData = {\n                                            created_date: dateValue,\n                                            gender: gender,\n                                            phone_number: phoneNumber,\n                                            reporter_state: state,\n                                            type: incidence,\n                                        }\n                                        let sql = 'INSERT INTO incidence SET ?';\n                                            con.query(sql, postData, function (err, result) {\n                                                if (err) {\n                                                    console.log(\"err\", err);\n                                                }else {\n                                                console.log(\"1 record inserted, ID: \" + result);\n                                                }\n                                            });\n                                        });\n                                        createClient(baseURL, username, password, shortcode, smsc, msisdn, SUCCESS_MESSAGE, metaValue16, keyword, id, smsBoxUrl);\n                                client.DEL(msisdn);\n                            } else if (text == '0') {\n                                const gender = ansExist.session.gender;\n                                const incidence = ansExist.session.incidence;\n                                const raw = { menu: '3', session: {msisdn: msisdn, gender: gender, incidence: incidence}}\n                                client.setex(msisdn, 360, stringifyData(raw));\n                                createClient(baseURL, username, password, shortcode, smsc, msisdn, STATE_ALPHABET_SELECTION, metaValueTwo, keyword, id, smsBoxUrl);\n                            } else if (text !== '0' || text !== '1' || text !== '2' || text !== '3' || text !== '4' || text !== '5' || text !== '6' || text !== '7' || text !== '8') {\n                                const gender = ansExist.session.gender;\n                                const incidence = ansExist.session.incidence;\n                                const raw = { menu: '3', session: {msisdn: msisdn, gender: gender, incidence: incidence}}\n                                client.setex(msisdn, 360, stringifyData(raw));\n                                createClient(baseURL, username, password, shortcode, smsc, msisdn, STATE_ALPHABET_SELECTION_INVALID, metaValueTwo, keyword, id, smsBoxUrl);\n                            }\n                            } \n                          });\n                        } else if (metaValue == '21' || metaValue == '13'){\n                            const empty = \"\";\n                            createClient(baseURL, username, password, shortcode, smsc, msisdn, empty, metaValue16, keyword, id, smsBoxUrl);\n                        } else {\n                            const empty = \"\";\n                            createClient(baseURL, username, password, shortcode, smsc, msisdn, empty, metaValue16, keyword, id, smsBoxUrl);\n                        }  \n                    } else {\n                        const empty = \"\";\n                        createClient(baseURL, username, password, shortcode, smsc, msisdn, empty, metaValue16, keyword, id, smsBoxUrl);\n                        }\n                } else {\n                    throw new Error('Incomplete query parameters received!');\n                }\n            } else {\n                throw new Error('Invalid query string')\n            }\n            \n        } else {\n            throw new Error('Invalid query string!');\n        }\n       \n    } catch(e){\n        console.log(\"error\", e);\n    }\n\n\n}\n}\n\n\n"],"file":"ussd-menu.js"}