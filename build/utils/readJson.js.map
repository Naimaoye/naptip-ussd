{"version":3,"sources":["../../src/utils/readJson.js"],"names":["readJson","res","cb","err","buffer","onData","ab","isLast","chunk","Buffer","from","json","JSON","parse","e","close","onAborted"],"mappings":";;;;;;;;;;;;;;AAAO,IAAMA,QAAQ,GAAG,SAAXA,QAAW,CAACC,GAAD,EAAMC,EAAN,EAAUC,GAAV,EAAkB;AACtC,MAAIC,MAAJ;AACA;;AACAH,EAAAA,GAAG,CAACI,MAAJ,CAAW,UAACC,EAAD,EAAKC,MAAL,EAAgB;AACzB,QAAIC,KAAK,GAAGC,MAAM,CAACC,IAAP,CAAYJ,EAAZ,CAAZ;;AACA,QAAIC,MAAJ,EAAY;AACV,UAAII,IAAJ;;AACA,UAAIP,MAAJ,EAAY;AACV,YAAI;AACFO,UAAAA,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAW,wBAAAJ,MAAM,MAAN,CAAAA,MAAM,EAAQ,CAACL,MAAD,EAASI,KAAT,CAAR,CAAjB,CAAP;AACD,SAFD,CAEE,OAAOM,CAAP,EAAU;AACV;AACAb,UAAAA,GAAG,CAACc,KAAJ;AACA;AACD;;AACDb,QAAAA,EAAE,CAACS,IAAD,CAAF;AACD,OATD,MASO;AACL,YAAI;AACFA,UAAAA,IAAI,GAAGC,IAAI,CAACC,KAAL,CAAWL,KAAX,CAAP;AACD,SAFD,CAEE,OAAOM,CAAP,EAAU;AACV;AACAb,UAAAA,GAAG,CAACc,KAAJ;AACA;AACD;;AACDb,QAAAA,EAAE,CAACS,IAAD,CAAF;AACD;AACF,KArBD,MAqBO;AACL,UAAIP,MAAJ,EAAY;AACVA,QAAAA,MAAM,GAAG,wBAAAK,MAAM,MAAN,CAAAA,MAAM,EAAQ,CAACL,MAAD,EAASI,KAAT,CAAR,CAAf;AACD,OAFD,MAEO;AACLJ,QAAAA,MAAM,GAAG,wBAAAK,MAAM,MAAN,CAAAA,MAAM,EAAQ,CAACD,KAAD,CAAR,CAAf;AACD;AACF;AACF,GA9BD;AAgCA;;AACAP,EAAAA,GAAG,CAACe,SAAJ,CAAcb,GAAd;AACD,CArCI","sourcesContent":["export const readJson = (res, cb, err) => {\n    let buffer;\n    /* Register data cb */\n    res.onData((ab, isLast) => {\n      let chunk = Buffer.from(ab);\n      if (isLast) {\n        let json;\n        if (buffer) {\n          try {\n            json = JSON.parse(Buffer.concat([buffer, chunk]));\n          } catch (e) {\n            /* res.close calls onAborted */\n            res.close();\n            return;\n          }\n          cb(json);\n        } else {\n          try {\n            json = JSON.parse(chunk);\n          } catch (e) {\n            /* res.close calls onAborted */\n            res.close();\n            return;\n          }\n          cb(json);\n        }\n      } else {\n        if (buffer) {\n          buffer = Buffer.concat([buffer, chunk]);\n        } else {\n          buffer = Buffer.concat([chunk]);\n        }\n      }\n    });\n  \n    /* Register error cb */\n    res.onAborted(err);\n  };"],"file":"readJson.js"}